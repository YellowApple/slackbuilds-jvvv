--- a/HandBrake.SlackBuild	2014-01-23 20:59:58.747109758 -0500
+++ b/HandBrake.SlackBuild	2014-04-12 17:15:24.145236713 -0400
@@ -25,15 +25,25 @@
 OUTPUT=${OUTPUT:-/tmp}
 
 if [ "$ARCH" = "i486" ]; then
+  SLKCFLAGS="-O2 -march=i486 -mtune=i686"
   LIBDIRSUFFIX=""
 elif [ "$ARCH" = "i686" ]; then
+  SLKCFLAGS="-O2 -march=i686 -mtune=i686"
   LIBDIRSUFFIX=""
 elif [ "$ARCH" = "x86_64" ]; then
+  SLKCFLAGS="-O2 -fPIC"
   LIBDIRSUFFIX="64"
 else
+  SLKCFLAGS="-O2"
   LIBDIRSUFFIX=""
 fi
 
+SLKCFLAGS="$SLKCFLAGS -fno-aggressive-loop-optimizations"
+saved_CFLAGS="$CFLAGS"
+saved_CXXFLAGS="$CFLAGS"
+export CFLAGS="$SLKCFLAGS"
+export CXXFLAGS="$SLKCFLAGS"
+
 set -e
 
 rm -rf $PKG
@@ -51,6 +61,8 @@
  \( -perm 666 -o -perm 664 -o -perm 640 -o -perm 600 -o -perm 444 \
  -o -perm 440 -o -perm 400 \) -exec chmod 644 {} \;
 
+CFLAGS="$SLKCFLAGS" \
+CXXFLAGS="$SLKCFLAGS" \
 ./configure \
   --prefix=/usr \
   --disable-gtk-update-checks \
@@ -64,6 +76,9 @@
   make install DESTDIR=$PKG
 cd $TMP/$PRGNAM-$VERSION
 
+export CFLAGS="$saved_CFLAGS"
+export CXXFLAGS="$saved_CXXFLAGS"
+
 mkdir -p $PKG/usr/doc/$PRGNAM-$VERSION
 cp -a AUTHORS COPYING CREDITS NEWS THANKS TRANSLATIONS \
  $PKG/usr/doc/$PRGNAM-$VERSION
